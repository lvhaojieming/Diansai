#include "AD9834.h" 
 
/**************************************************************** 
** �������� ��AD9834_Write_16Bits
** �������� ����AD9834д��16Ϊ����
** ��ڲ��� ��data --  Ҫд���16λ����
** ���ڲ��� ����
** ����˵�� ����
*****************************************************************/ 
void AD9834_Write_16Bits(uint32_t data) 
{ 
    uint8_t i = 0 ; 
 
    AD9834_SCLK_SET ; 
    AD9834_FSYNC_CLR ; 
 
    for(i=0; i<16; i++)      
		{ 
        if(data & 0x8000) 
          AD9834_SDATA_SET ; 
        else 
          AD9834_SDATA_CLR ; 
 
        AD9834_SCLK_CLR;
        data <<= 1 ; 
        AD9834_SCLK_SET ; 
    } 
 
    AD9834_SDATA_SET;
    AD9834_FSYNC_SET;
}  
 
/**************************************************************** 
** �������� ��AD9834_Init
** �������� ����ʼ��AD9834����
** ��ڲ��� ����
** ���ڲ��� ����
** ����˵�� ����
*****************************************************************/ 
void AD9834_Init(void) 
{
	
	HAL_GPIO_WritePin(GPIOA ,AD9834_PS ,GPIO_PIN_RESET);
	HAL_GPIO_WritePin(GPIOA ,AD9834_FS ,GPIO_PIN_RESET);
	
		AD9834_Write_16Bits(0x2100);
		AD9834_Write_16Bits(0x2038);
		AD9834_Write_16Bits(0XC000);
		AD9834_Write_16Bits(0x2100);
	
}
 
/**************************************************************** 
** �������� ��AD9834_SetPhase
** �������� ������Ƶ��ֵ
** ��ڲ��� ��reg -- Ҫд���ƽ�ʼĴ���(FREQ_REG_0FREQ_REG_1) 
						 fre -- Ƶ��ֵ  				��Χ����0Hz~268435455Hz��
						 type -- �������ͼ����Ʒ�ʽ  ���ͣ����ǲ������������Ҳ��������Ʒ�ʽ�����ſ��ƻ�λ���ƣ�
** ���ڲ��� ����
** ����˵�� ���Ĵ����ġ�PIN/SW��λΪ1ʱ��ʹ����Ӧ�Ŀ�������������Ƶ�ʼĴ���
						 �Ĵ����ġ�PIN/SW��λΪ0ʱ��ʹ����Ӧ�Ŀ���λ������Ƶ�ʼĴ���
*****************************************************************/ 
void AD9834_SetFrequency(uint16_t reg, float fre,uint16_t type)
{
 
	uint16_t freqHi = reg;
	uint16_t freqLo = reg;
 
	unsigned long val=(268435456.0/AD9834_SYSTEM_COLCK)*fre;
	freqHi |= ((val & 0xFFFC000) >> 14);
	freqLo |= ((val&0x3FFF));
 
	AD9834_Write_16Bits(type);
	AD9834_Write_16Bits(freqLo);
	AD9834_Write_16Bits(freqHi);
 
}
 
/*********************************************************************************************************
** �������� ��AD9834_SetPhase
** �������� ��������λ
** ��ڲ��� ��reg--Ҫд��ļĴ���(PHASE_REG_0��PHASE_REG_1)
						 val--��λֵ						��Χ��(0~4095��Ӧ0��~360��)
** ���ڲ��� ����
** ����˵�� ���Ĵ����ġ�PIN/SW��λΪ1ʱ��ʹ����Ӧ�Ŀ���������������λ�Ĵ���
						 �Ĵ����ġ�PIN/SW��λΪ0ʱ��ʹ����Ӧ�Ŀ���λ��������λ�Ĵ���
*********************************************************************************************************/
void AD9834_SetPhase(uint16_t reg, uint16_t val)
{
	uint16_t phase = reg|val;
	AD9834_Write_16Bits(phase);
}
 

